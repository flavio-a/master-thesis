\chapter{Conclusions}\label{ch:conclusions}
In the past, the focus of formal static analyses has been on over-approximation to show correctness, but many tools based on this theory are instead deployed to catch bugs. This suggest the study of a theory for under-approximation to give a formal basis to those tools, but this has seldom been done in the past few decades, especially in the framework of abstract interpretation.
In this thesis, we tried to expose the reasons why designing an under-approximation abstract domain is hard. We compared over and under-approximation in Chapter \ref{ch3:comparison}, highlighting similarities and asymmetries between the two, and why those are an obstacle to under-approximation. On this conceptual level, we showed that there is a complete symmetry for domains while functions are unchanged, leading to different focus on which concrete elements are interesting. The other main difference we identified is handling absence of information, that in under-approximation is described the same way as divergence, leading to analysis that are tampered when they have no information because, for correctness, they behave as if the program diverged at that point.
On the technical side, we proposed the new (to the extent of our knowledge) definition of \emph{non emptying function}, motivated by high level observations explained in Chapter \ref{ch3:comparison}, and studied how it can be used to prove non existence of under-approximation abstract domains. We presented some general results, and applied them to integer and floating point domains to get that, under some assumptions, there are no useful under-approximation domains. We then found conditions under which there do exist under-approximation abstract domains, showing that some of the hypothesis required in our theorems are tight and finding limitations of approaches based on non emptying functions.
However, we believe there are many directions for possible future research.

As stated in Chapter \ref{ch3:comparison}, a possibility to define under-approximation abstract domains is to consider disjunctive completion of over-approximation domains. This has been done for over-approximation to improve precision \cite{file-disjunctive-completion}, but with the need for heuristics to join disjunctions and avoid exponential explosion of their number.
In under-approximation, a sound technique to reduce the number of disjunctions is dropping some, but also this needs heuristics to choose which. The same issue is present in O'Hearn's incorrectness logic \cite{ohearn-incorrectness-logic}, and he observes that tools deployed for bug catching (for instance Infer.Pulse, a tool developed at Facebook) implement heuristics for this. It's possible those could be used in tools based on abstract interpretation or studied in theory as well.

We showed limitations of approaches based on non emptying function to prove that no abstract domain exists for a given concrete one, mainly in the presence of ``boundaries". However, Example \ref{ch4:ex:infinite-lists-fix-c0} and Theorem \ref{ch4:th:non-empt-res-finite-global} raise the question of what can be done if, alongside constraining the function family $F$, we also require some concrete elements to be representable. It allows to get rid of high surjectivity and possibly to overcome issues with boundaries, but requiring conditions on the abstract domain itself is quite a strong assumption in our opinion, since we could in principle fix the domain based on the program to analyse. So, together with a technical development, this approach would also require a justification of the choice being made.

In their recent work, Raad et al. \cite{incorrectness-separation-logic} study incorrectness separation logic, the union of separation logic \cite{reynolds-incorrectness-logic} and O'Hearn's incorrectness logic. They notice that the original separation logic doesn't distinguish a pointer known to be dangling from one about which it has no information, and they introduce a new kind of heap assertion for dangling pointers. This issue is reminiscent of the difference between divergence and no information we incur into in abstract interpretation. However, it is unclear \textit{where} in the abstract domain this point should be added. A simple approach would be to have a point representing divergence right above $\bot$ (no information), lower than any other abstract point.
However we need a concretization for this new abstract point, and this can't be $\emptyset$ because it already represents absence of information. In general, a concrete power set has no element different from $\emptyset$ suitable to represent divergence, but it may be possible to introduce it changing the concrete domain. This could remove one of the biggest limitations of under-approximation abstract domain design, so future work in this direction may be beneficial.

All results presented in this thesis depends on the existence of a value in $R$, representable on its own. This assumption is motivated by the analysis, but is not required by the abstract interpretation framework. A possible way to remove it is to consider representable sets of minimal cardinality because functions defined as additive extensions don't increase cardinality, so they might take the place of singletons. The issue is how to generalize Lemma \ref{ch3:th:f-non-repr-pair}, but we believe it may be possible to relax that hypothesis.

We briefly discussed finite domains, but we left many open questions. We presented two results for infinite domains, but we only translated one of them to the finite case, and even adding hypotheses. We presented a construction to show that high surjectivity is a tight condition for infinite domains, but the same construction for finite ones yields a cardinality much smaller than the one required in the theorem. Finiteness introduces limitations because arbitrary composition of small sets may grow larger, but also opens up new possibilities since this may also allow to show that the number of representable elements is too large.
To sum up, finite domains still require a thorough study.
